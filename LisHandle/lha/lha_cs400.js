data = `1H|\^&|||Analyzer ID|||||HOST||1|20211203214524
58
2P|1|||||||Male||||||^Y
C1
3O|1|khuyen^1^1^1|||R|20211203075540|||||||||1||||||||||O
B2
4R|1|^^^ALT|9.59|U/L|0^40\^|||F||||20211203075540
E9
5R|2|^^^AST|37.14|U/L|0^34\^|H||F||||20211203075540
65
6R|3|^^^GLU|7.79|mmol/l|3.89^6.11\^|H||F||||20211203075540
C0
7R|4|^^^CRE|86.09|umol/l|53^115\^|H||F||||20211203075540
53
0L|1|N
03
1H|\^&|||Analyzer ID|||||HOST||1|20211203214524
58
2P|2|||||||Male||||||^Y
C2
3O|1|taam^2^1^2|||R|20211203075555|||||||||1||||||||||O
C9
4R|1|^^^ALT|40.56|U/L|0^40\^|H||F||||20211203075555
5F
5R|2|^^^AST|36.89|U/L|0^34\^|H||F||||20211203075555
76
6R|3|^^^GLU|5.11|mmol/l|3.89^6.11\^|H||F||||20211203075555
B6
7R|4|^^^CRE|97.42|umol/l|53^115\^|H||F||||20211203075555
58
0L|1|N
03
1H|\^&|||Analyzer ID|||||HOST||1|20211203214524
58
2P|3|||||||Male||||||^Y
C3
3O|1|01^3^1^3|||R|20211203075607|||||||||1||||||||||O
87
4R|1|^^^GLU|10.05|mmol/l|3.89^6.11\^|H||F||||20211203075607
DF
5R|2|^^^TG|1.13|mmol/l|0.4^1.81\^|H||F||||20211203075607
25
6R|3|^^^CHO|6.62|mmol/l|0^0\^|H||F||||20211203075607
75
7L|1|N
0A
0H|\^&|||Analyzer ID|||||HOST||1|20211203214524
57
1P|4|||||||Male||||||^Y
C3
2O|1|02^4^1^4|||R|20211203075616|||||||||1||||||||||O
89
3R|1|^^^ALT|17.26|U/L|0^40\^|H||F||||20211203075616
5D
4R|2|^^^AST|22.80|U/L|0^34\^|H||F||||20211203075616
65
5R|3|^^^GLU|16.47|mmol/l|3.89^6.11\^|H||F||||20211203075616
EE
6L|1|N
09
7H|\^&|||Analyzer ID|||||HOST||1|20211203214524
5E
0P|5|||||||Male||||||^Y
C3
1O|1|03^5^1^5|||R|20211203075625|||||||||1||||||||||O
8B
2R|1|^^^ALT|7.40|U/L|0^40\^|H||F||||20211203075625
27
3R|2|^^^AST|18.96|U/L|0^34\^|H||F||||20211203075625
70
4R|3|^^^GLU|7.33|mmol/l|3.89^6.11\^|H||F||||20211203075625
B8
5R|4|^^^CRE|118.94|umol/l|53^115\^|H||F||||20211203075625
85
6L|1|N
09
`


var end_stt_pattern = '|||||||||1||||||||||O';
var result = [];

data = data.replace(/\u0002|\u0003/g,'');
if(data.indexOf('\n') != -1){
	var rows = data.split('\n');
}
else{
	var rows = data.split('\r');
}
var item_xn = new Object();
var currentStt = 0;
for(var i = 0;i < rows.length;i++){
	currentRow = rows[i]
	if(currentRow.match(/^\d+O\|/)){
		
		currentStt = currentRow.split('|')[2].split('^')[0];
		
	}
	if(currentRow.match(/^\d+R/) != null){
        item_xn = new Object();
        item_xn.stt = currentStt;
		item_xn.ma_xn_may = currentRow.split('|')[2].replace(/\^/g,'');
		item_xn.ketqua = currentRow.split('|')[3].trim();
        result.push(item_xn);
	}
}

return result;

